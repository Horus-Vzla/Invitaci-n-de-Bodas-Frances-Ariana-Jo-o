<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invitación Ariana & João</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center; 
            margin: 0;
            padding: 0;
            background-color: #f4f4f4; 
            min-height: 100vh;
            overflow: auto; 
            font-family: sans-serif;
            position: relative;
        }

        .invitation-container {
            width: 100%;
            max-width: 1080px;
            aspect-ratio: 1080 / 1920; 
            
            background-image: url('Tarjeta Ariana & João Frances.jpg'); 
            background-size: cover; 
            background-position: center; 
            background-repeat: no-repeat; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: relative; 
            overflow: hidden;
        }

        /* Estilos para los enlaces (hotspots) - sin cambios */
        .hotspot {
            position: absolute;
            background-color: rgba(255, 255, 255, 0); 
            cursor: pointer;
            z-index: 10; 
        }

        .hotspot-ceremonie {
            top: 79.5%; 
            left: 15.7%; 
            width: 23%; 
            height: 12.5%; 
        }

        .hotspot-reception {
            top: 79.5%; 
            left: 38.5%; 
            width: 23%; 
            height: 12.5%; 
        }

        .hotspot-confirmation {
            top: 79.5%; 
            left: 61.3%; 
            width: 23%; 
            height: 12.5%; 
        }

        /* --- Estilos para el Reproductor de Música Personalizado --- */
        .custom-player {
            position: fixed; 
            bottom: 20px; 
            left: 50%; 
            transform: translateX(-50%); 
            width: 90%; 
            max-width: 400px; 
            background-color: rgba(198, 216, 231, 0.05); /* 5% de opacidad */
            border-radius: 10px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 20; 
            transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out; 
        }
        
        /* Clase para OCULTAR PERMANENTEMENTE */
        .custom-player.hide-player {
            opacity: 0; 
            pointer-events: none; 
            transform: translate(-50%, 50px); 
        }

        /* Estilo para el mensaje de "Écoutez Notre Chanson" */
        .initial-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #4A6C9B;
            font-size: 1em;
            font-weight: bold;
            pointer-events: none;
            transition: opacity 0.4s;
        }
        
        .message-hidden {
            opacity: 0;
        }

        .play-pause-btn {
            background: none;
            border: none;
            font-size: 1.8em;
            color: #4A6C9B; 
            cursor: pointer;
            padding: 0 10px;
            outline: none;
        }

        /* Oculta los controles de tiempo y progreso, dejando visible solo el mensaje y el botón de Play */
        .progress-bar-container, .time-display {
            visibility: hidden; 
        }
        
        .progress-bar-container {
            flex-grow: 1; 
            height: 8px;
            background-color: rgba(74, 108, 155, 0.3); 
            border-radius: 5px;
            margin: 0 10px;
            cursor: pointer;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            width: 0%; 
            background-color: #4A6C9B; 
            border-radius: 5px;
        }

        .time-display {
            font-size: 0.9em;
            color: #4A6C9B; 
            margin-left: 5px;
            width: 80px; 
            text-align: right;
        }

        audio {
            display: none;
        }
    </style>
</head>
<body>
    
    <audio id="background-music" loop> 
        <source src="sam smith - stay with me (lyrics).mp3" type="audio/mp3">
        Tu navegador no soporta el elemento de audio.
    </audio>

    <div class="invitation-container">
        <a href="https://maps.app.goo.gl/XWS8NYfkEneNpyXQ9" class="hotspot hotspot-ceremonie" title="Cérémonie"></a>
        <a href="https://maps.app.goo.gl/QvWwx8subzEm66j27" class="hotspot hotspot-reception" title="Réception de Mariage"></a>
        <a href="https://forms.gle/mTm95jnBT17j9qoT9" class="hotspot hotspot-confirmation" title="Confirmer votre Présence"></a>
    </div>

    <div class="custom-player">
        <button id="play-pause-btn" class="play-pause-btn">▶</button>
        <div class="progress-bar-container" id="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        <span id="initial-message" class="initial-message">Écoutez Notre Chanson</span>
        <div class="time-display" id="time-display">00:00 / 00:00</div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const audio = document.getElementById('background-music');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const progressContainer = document.getElementById('progress-container');
            const playerElement = document.querySelector('.custom-player');
            const initialMessage = document.getElementById('initial-message'); 

            let isPlaying = false;
            let hasPlayed = false;
            
            // Función central para iniciar la reproducción y ocultar la barra
            function startPlaybackAndHidePlayer() {
                if (hasPlayed) return; // Ya está tocando y oculto, salimos.
                
                audio.play().then(() => {
                    // Si la reproducción comienza:
                    
                    // 1. Ocultamos el botón de Play/Pause y el mensaje.
                    playPauseBtn.style.opacity = '0';
                    initialMessage.classList.add('message-hidden');
                    
                    // 2. Ocultamos la barra completa (el contenedor principal).
                    // Damos un pequeño retraso para un efecto de desvanecimiento suave
                    setTimeout(() => {
                        playerElement.classList.add('hide-player');
                    }, 500); 

                    isPlaying = true;
                    hasPlayed = true;
                }).catch(error => {
                    // Si falla el auto-play, mantenemos el botón visible y listo para el clic
                    console.log("La lecture audio automatique a été bloquée. En attente d'interaction.");
                    isPlaying = false;
                });
            }

            // --- Lógica del Reproductor de Música ---

            // La primera interacción del usuario con el botón inicia la canción y oculta la barra
            playPauseBtn.addEventListener('click', function() {
                if (!isPlaying) {
                    startPlaybackAndHidePlayer();
                } else {
                    // Si ya está tocando y el usuario hace clic, pausa. (Aunque el botón está invisible)
                    audio.pause();
                    playPauseBtn.textContent = '▶'; 
                    isPlaying = false;
                }
            });

            // Si el usuario hace clic en el área de la barra para saltar, también debe iniciar y ocultar
            progressContainer.addEventListener('click', function(e) {
                if (!isPlaying) {
                    startPlaybackAndHidePlayer();
                }
            });


            // Funciones auxiliares para el audio (se mantienen)
            audio.addEventListener('timeupdate', function() {
                const progressBar = document.getElementById('progress-bar');
                const timeDisplay = document.getElementById('time-display');
                const progressPercent = (audio.currentTime / audio.duration) * 100;
                progressBar.style.width = progressPercent + '%';
                timeDisplay.textContent = `${formatTime(audio.currentTime)} / ${formatTime(audio.duration)}`;
            });

            audio.addEventListener('loadedmetadata', function() {
                 const timeDisplay = document.getElementById('time-display');
                 timeDisplay.textContent = `00:00 / ${formatTime(audio.duration)}`;
            });

            audio.addEventListener('ended', function() {
                audio.currentTime = 0; 
                audio.play(); 
            });

            function formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = Math.floor(seconds % 60);
                return `${minutes < 10 ? '0' : ''}${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
            }

            // Intenta iniciar la reproducción tan pronto como se carga
            startPlaybackAndHidePlayer();
            
        });
    </script>
</body>
</html>
